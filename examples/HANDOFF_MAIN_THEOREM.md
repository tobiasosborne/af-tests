# Handoff: Proving the Main Theorem (H = A_N or S_N)

## Overview

This document provides detailed guidance for proving the **Main Theorem** using the `af` (Adversarial Proof Framework) tool.

**Master Reference:** See `./proof_master.md` for the complete proof structure:
- Main Theorem: lines 566–590
- Dependency graph: lines 593–629

---

## Main Theorem Statement

**For n + k + m >= 1:**
$$H = \langle g_1, g_2, g_3 \rangle = \begin{cases} A_N & \text{if } n, k, m \text{ all odd} \\ S_N & \text{otherwise} \end{cases}$$

**Location:** `./lemmas/main_theorem/`

**Current Status:** 1 pending node (root claim ready for proof)

---

## All Dependencies Are NOW VALIDATED

All prerequisite lemmas have been validated with the adversarial framework:

| Lemma | Statement | Status | Taint |
|-------|-----------|--------|-------|
| **Lemma 5** | H acts transitively on Omega | VALIDATED | clean |
| **Lemma 9** | H contains the 3-cycle (1 6 2) | VALIDATED | clean |
| **Lemma 11** | H acts primitively on Omega (for n+k+m >= 1) | VALIDATED | clean |
| **Lemma 12** | Jordan's Theorem: primitive + 3-cycle => contains A_n | ADMITTED | self_admitted |
| **Lemma 13** | Sign of l-cycle is (-1)^{l-1} | VALIDATED | clean |
| **Lemma 14** | sign(g_1) = (-1)^{n+3}, sign(g_2) = (-1)^{k+3}, sign(g_3) = (-1)^{m+3} | VALIDATED | clean |
| **Lemma 15** | G = A_n iff all generators even; G = S_n iff contains odd permutation | VALIDATED | clean |

**Note on Taint:** The Main Theorem will inherit `self_admitted` taint from Lemma 12 (Jordan's Theorem), which is admitted as a classical axiom. This is expected and appropriate.

---

## Proof Strategy

The Main Theorem follows from a 6-step chain combining the validated lemmas:

1. **Transitivity (Lemma 5):** H = <g_1, g_2, g_3> acts transitively on Omega
2. **Primitivity (Lemma 11):** H acts primitively on Omega (when n + k + m >= 1)
3. **Contains 3-cycle (Lemma 9):** H contains the 3-cycle (1 6 2)
4. **Apply Jordan (Lemma 12):** Since H is primitive and contains a 3-cycle, H >= A_N
5. **Parity Analysis (Lemma 14):** Determine which generators are even/odd
6. **Conclusion (Lemma 15):** Apply the A_N vs S_N criterion

---

## How to Add Definitions

Before proving, add all necessary definitions using `af def-add`. The syntax is:

```bash
af def-add <name> "<content>"
```

### Required Definitions for Main Theorem

```bash
# Navigate to the main theorem directory first
cd /home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem

# Check current state
af status
af defs

# Add domain definitions
af def-add Omega "Omega := {1, 2, 3, 4, 5, 6, a_1, ..., a_n, b_1, ..., b_k, c_1, ..., c_m} with |Omega| = N = 6 + n + k + m."

af def-add H "H := <g_1, g_2, g_3>, the group generated by the three (4+tail)-cycles acting on Omega."

af def-add Generators "g_1 = (1 4 a_1...a_n 2 5) is a (4+n)-cycle; g_2 = (2 5 b_1...b_k 3 6) is a (4+k)-cycle; g_3 = (3 6 c_1...c_m 1 4) is a (4+m)-cycle."

# Add validated lemma references
af def-add Lemma_5 "Lemma 5 (VALIDATED): H = <g_1, g_2, g_3> acts transitively on Omega."

af def-add Lemma_9 "Lemma 9 (VALIDATED): H contains the 3-cycle (1 6 2)."

af def-add Lemma_11 "Lemma 11 (VALIDATED): If n + k + m >= 1, then H acts primitively on Omega."

af def-add Lemma_12 "Lemma 12 - Jordan's Theorem (ADMITTED): Let G <= S_n be primitive with n >= 5. If G contains a 3-cycle, then G >= A_n."

af def-add Lemma_14 "Lemma 14 (VALIDATED): sign(g_1) = (-1)^{n+3}, sign(g_2) = (-1)^{k+3}, sign(g_3) = (-1)^{m+3}."

af def-add Lemma_15 "Lemma 15 (VALIDATED): For G with A_n <= G <= S_n: G = A_n iff all generators are even; G = S_n iff G contains an odd permutation."

# Add key concepts
af def-add Parity_Analysis "(-1)^{x+3} = +1 (even) iff x is odd. So sign(g_i) is even iff the corresponding tail length is odd."

af def-add A_N "A_N is the alternating group on N = 6 + n + k + m elements."

af def-add S_N "S_N is the symmetric group on N = 6 + n + k + m elements."
```

---

## Step-by-Step Proof Commands

### Prover Workflow

```bash
# Navigate to the main theorem directory
cd /home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem

# Check current state
af status

# Add definitions (as shown above)
# ... run all af def-add commands ...

# Claim root node as prover
af claim 1 --owner prover-1 --role prover

# Build proof structure
af refine 1 --owner prover-1 -s "PROOF OVERVIEW: We prove H = A_N or S_N by combining six validated lemmas: (1) transitivity, (2) primitivity, (3) 3-cycle existence, (4) Jordan's theorem, (5) parity analysis, (6) A_N vs S_N criterion."

af refine 1.1 --owner prover-1 --sibling -s "STEP 1 - TRANSITIVITY (Lemma 5): By Lemma 5 (validated), the group H = <g_1, g_2, g_3> acts transitively on Omega. This was established via the connectivity of the support graph of the generators."

af refine 1.2 --owner prover-1 --sibling -s "STEP 2 - PRIMITIVITY (Lemma 11): By Lemma 11 (validated), when n + k + m >= 1, the group H acts primitively on Omega. This was proven using Lemmas 5, 10, and 11.5, showing H preserves no non-trivial block system."

af refine 1.3 --owner prover-1 --sibling -s "STEP 3 - CONTAINS 3-CYCLE (Lemma 9): By Lemma 9 (validated), H contains the 3-cycle (1 6 2). This was extracted from commutators of the generators."

af refine 1.4 --owner prover-1 --sibling -s "STEP 4 - APPLY JORDAN (Lemma 12): By Lemma 12 (Jordan's Theorem, admitted as axiom), since H is primitive (Step 2) and contains a 3-cycle (Step 3), we conclude H >= A_N. Note: N = 6 + n + k + m >= 7 when n + k + m >= 1, so N >= 5 as required."

af refine 1.5 --owner prover-1 --sibling -s "STEP 5 - PARITY ANALYSIS (Lemma 14): By Lemma 14 (validated), sign(g_1) = (-1)^{n+3}, sign(g_2) = (-1)^{k+3}, sign(g_3) = (-1)^{m+3}. Now (-1)^{x+3} = +1 iff x+3 is even iff x is odd. Therefore: all generators are even iff n, k, m are all odd."

af refine 1.6 --owner prover-1 --sibling -s "STEP 6 - CONCLUSION (Lemma 15): By Lemma 15 (validated), since H >= A_N (Step 4): (Case 1) If n, k, m are all odd, then all generators are even (Step 5), so H <= A_N, thus H = A_N. (Case 2) Otherwise, some generator is odd (Step 5), so H contains an odd permutation, thus H = S_N. QED."

# Release the root node
af release 1 --owner prover-1

# Check status
af status
```

---

## Spawning Verifier Agents

For maximum rigor, spawn parallel verifier agents. The proof has 7 nodes, so 2-3 verifiers are recommended.

### Verifier 1: Check nodes 1.1, 1.2, 1.3

```
You are VERIFIER-1 for the Main Theorem (H = A_N or S_N). Verify nodes 1.1, 1.2, and 1.3 with EXTREME RIGOR.

Working directory: /home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem

WORKFLOW:
1. Run `af status` and `af defs` to see current state
2. For each node (1.1, 1.2, 1.3):
   - `af claim <node> --owner verifier-1 --role verifier`
   - `af show <node>`
   - Verify the lemma citation is correct and the logic is sound
   - If SATISFIED: `af accept <node> --agent verifier-1 --confirm` then `af release <node> --owner verifier-1`
   - If issues found: `af challenge <node> --owner verifier-1 --target statement --severity major --reason "<reason>"`

CRITICAL CHECKS:
- Node 1.1: Does it correctly cite Lemma 5 for transitivity?
- Node 1.2: Does it correctly cite Lemma 11 for primitivity? Is n + k + m >= 1 stated?
- Node 1.3: Does it correctly cite Lemma 9 for the 3-cycle (1 6 2)?
```

### Verifier 2: Check nodes 1.4, 1.5

```
You are VERIFIER-2 for the Main Theorem. Verify nodes 1.4 and 1.5 with EXTREME RIGOR.

Working directory: /home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem

WORKFLOW:
1. Run `af status` to see current state
2. For each node (1.4, 1.5):
   - Claim, verify, accept/challenge, release

CRITICAL CHECKS:
- Node 1.4 (Jordan): Does it correctly cite Lemma 12? Is the N >= 5 requirement addressed?
- Node 1.5 (Parity): Does it correctly cite Lemma 14? Is the parity analysis correct?
  - Check: (-1)^{x+3} = +1 iff x is odd
  - Verify: "all generators even iff n, k, m all odd"
```

### Verifier 3 (Final): Check node 1.6 and root

```
You are VERIFIER-FINAL for the Main Theorem. Verify node 1.6 and the root node.

Working directory: /home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem

WORKFLOW:
1. Wait for nodes 1.1-1.5 to be validated
2. Verify node 1.6 (Conclusion):
   - Does it correctly cite Lemma 15?
   - Does it correctly combine Steps 4 and 5?
   - Are both cases (H = A_N and H = S_N) properly justified?
3. Verify root node 1:
   - Are all child nodes validated?
   - Does the proof chain establish the theorem?
4. Accept and release

NOTE: The proof will have 'self_admitted' taint from Lemma 12 (Jordan). This is expected.
```

---

## af Command Quick Reference

```bash
# Status and inspection
af status                    # View proof tree
af defs                      # List all definitions
af def <name>                # View specific definition
af show <node>               # View node details
af challenges                # List all challenges

# Adding definitions
af def-add <name> "<content>"

# Prover workflow
af claim <node> --owner <id> --role prover
af amend <node> --owner <id> --statement "<new statement>"
af refine <node> --owner <id> -s "<statement>"
af refine <node> --owner <id> --sibling -s "<statement>"
af release <node> --owner <id>

# Verifier workflow
af claim <node> --owner <id> --role verifier
af challenge <node> --owner <id> --target <target> --severity <severity> --reason "<reason>"
af accept <node> --agent <id> [--confirm]
af release <node> --owner <id>

# Challenge resolution
af resolve-challenge <challenge-id> --owner <id> --explanation "<explanation>"

# Challenge targets: statement, inference, dependencies, gap, domain, scope, context, type_error, completeness
# Challenge severities: critical (blocks), major (blocks), minor, note
```

---

## Key Lessons from Previous Proofs

### 1. Node Reference Errors Are Common
In Lemmas 11, 14, and 15, verifiers caught incorrect node references in conclusion nodes. Always double-check that conclusion nodes reference the correct child nodes.

### 2. Spawn Independent Verifiers with Extreme Rigor
Independent verifiers catch errors that a single reviewer might miss. The adversarial framework is most effective when verifiers demand precise justification.

### 3. Parity Arithmetic Must Be Explicit
For the parity analysis (Step 5), make the arithmetic explicit:
- (-1)^{x+3} = (-1)^x * (-1)^3 = (-1)^x * (-1) = -(-1)^x
- So (-1)^{x+3} = +1 iff (-1)^x = -1 iff x is odd

### 4. Jordan's Theorem Introduces Taint
Lemma 12 is admitted as an axiom, so the Main Theorem will have `self_admitted` taint. This is appropriate for a classical result with 150+ years of verification.

---

## Dependency Graph for Main Theorem

```
MAIN THEOREM: H = A_N or S_N
│
├── Step 1: Lemma 5 (Transitivity) ─────────────── VALIDATED
│
├── Step 2: Lemma 11 (Primitivity) ─────────────── VALIDATED
│   ├── Lemma 5
│   ├── Lemma 10
│   └── Lemma 11.5
│       ├── Lemma 11.1
│       ├── Lemma 11.2
│       ├── Lemma 11.3
│       └── Lemma 11.4
│
├── Step 3: Lemma 9 (3-cycle) ──────────────────── VALIDATED
│   ├── Lemma 6
│   ├── Lemma 7
│   └── Lemma 8
│
├── Step 4: Lemma 12 (Jordan) ──────────────────── ADMITTED (axiom)
│
├── Step 5: Lemma 14 (Generator Parity) ────────── VALIDATED
│   └── Lemma 13
│
└── Step 6: Lemma 15 (A_N vs S_N criterion) ────── VALIDATED
```

---

## Expected Outcome

After completing this proof:

```
=== Proof Status ===

1 [validated/self_admitted] For n + k + m >= 1: H = A_N if n,k,m all odd, else H = S_N
  1.1 [validated/clean] STEP 1 - TRANSITIVITY (Lemma 5)
  1.2 [validated/clean] STEP 2 - PRIMITIVITY (Lemma 11)
  1.3 [validated/clean] STEP 3 - CONTAINS 3-CYCLE (Lemma 9)
  1.4 [validated/self_admitted] STEP 4 - APPLY JORDAN (Lemma 12)
  1.5 [validated/clean] STEP 5 - PARITY ANALYSIS (Lemma 14)
  1.6 [validated/clean] STEP 6 - CONCLUSION (Lemma 15)

--- Statistics ---
Nodes: 7 total
  Epistemic: 0 pending, 7 validated
  Taint: some self_admitted (from Lemma 12)
```

**Note:** The `self_admitted` taint on nodes 1.4 and 1 is expected because they depend on Jordan's Theorem (Lemma 12), which is admitted as a classical axiom.

---

## Checklist Before Starting

- [ ] Navigate to `/home/tobiasosborne/Projects/af-tests/examples/lemmas/main_theorem`
- [ ] Run `af status` to see current state (should be 1 pending node)
- [ ] Run `af defs` to check existing definitions (may be empty)
- [ ] Add ALL required definitions using `af def-add` (12 definitions)
- [ ] Claim root node as prover
- [ ] Create proof structure with `af refine` (6 step nodes)
- [ ] Release the root node
- [ ] Spawn parallel verifier agents (3 verifiers recommended)
- [ ] Resolve any challenges raised
- [ ] Have final verifier accept root node
- [ ] Verify all nodes are `validated` (with expected taint from Lemma 12)

---

## References

- **Master document:** `./proof_master.md` (lines 566-590 for Main Theorem)
- **Lemma handoffs:** `./HANDOFF_LEMMA*.md` for individual lemma proofs
- **Validated lemmas:** All in `./lemmas/lemma*_*/`

---

## Congratulations!

Once the Main Theorem is validated, you will have completed the full proof that:

> **For n + k + m >= 1, the group H = <g_1, g_2, g_3> equals A_N if n, k, m are all odd, and equals S_N otherwise.**

This is a significant result in computational group theory, showing that specific cycle generators produce either the alternating or symmetric group depending on parity conditions.
