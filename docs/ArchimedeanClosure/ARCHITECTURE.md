# Archimedean Closure Proof Architecture

## Overview

Formalization of the theorem: **A ‚àà MÃÑ ‚ü∫ A is nonnegative in all constrained *-representations**

where M is the quadratic module generated by self-adjoint generators subject to positivity constraints.

---

## Mathlib Infrastructure Assessment

### Available (Can Reuse)

| Component | Mathlib Location | Notes |
|-----------|------------------|-------|
| Riesz Extension | `Analysis.Convex.Cone.Extension` | `riesz_extension` theorem |
| Convex Cones | `Geometry.Convex.Cone.Basic` | `ConvexCone R E` |
| Proper Cones | `Analysis.Convex.Cone.Basic` | `ProperCone R E` |
| Cone Closure | `Analysis.Convex.Cone.Closure` | `ConvexCone.closure` |
| Tychonoff | `Topology.Compactness.Compact` | `isCompact_pi_infinite` |
| Weak-* topology | `Topology.Algebra.Module.WeakDual` | `WeakDual ùïú E` |
| Seminorms | `Analysis.Seminorm` | `Seminorm ùïú E` |
| Gauge (Minkowski) | `Analysis.Convex.Gauge` | `gauge`, `gaugeSeminorm` |
| Star algebras | `Algebra.Star.Basic` | `StarRing`, `StarModule` |
| Free algebras | `Algebra.FreeAlgebra` | `FreeAlgebra R X` (NOT *-algebras) |
| Cauchy-Schwarz | AfTests/GNS | Custom, reusable |
| GNS Construction | AfTests/GNS | Complete, 1956 LOC |

### Must Build

| Component | Dependency | Est. LOC |
|-----------|------------|----------|
| Free *-algebra with SA generators | FreeAlgebra | ~100 |
| Quadratic module M | Free *-algebra | ~80 |
| Archimedean property | M | ~40 |
| M-positive states | M, ContinuousLinearMap | ~80 |
| Constrained *-representations | StarAlgHom | ~60 |
| Generating cone lemma | ConvexCone | ~40 |
| Seminorm ||¬∑||_M | M-positive states | ~60 |
| State space compactness | Tychonoff, M | ~80 |
| Dual characterization | Riesz extension | ~120 |
| GNS for constrained reps | GNS infrastructure | ~80 |

**Total estimated new code: ~740 LOC**

---

## Phase Architecture

### Phase 1: Algebraic Setup (4 files, ~220 LOC)

#### File 1.1: `FreeStarAlgebra.lean` (~50 LOC)
```
Defines the free *-algebra with self-adjoint generators.
Uses FreeAlgebra with quotient by star relations.
```

**Key definitions:**
- `FreeStarAlgebra (n : ‚Ñï)` - Free *-algebra on n self-adjoint generators
- `generator (j : Fin n)` - The j-th generator g‚±º
- `isSelfAdjoint_generator` - star(g‚±º) = g‚±º

**Mathlib deps:** `Algebra.FreeAlgebra`, `Algebra.Star.Basic`

#### File 1.2: `QuadraticModule.lean` (~50 LOC)
```
The quadratic module M = {Œ£ a·µ¢*a·µ¢ + Œ£ b‚±º‚Çñ*g‚±ºb‚±º‚Çñ}
```

**Key definitions:**
- `QuadraticModule (A : Type*) [StarRing A] (gens : Fin n ‚Üí A)` - The cone M
- `mem_quadraticModule` - Membership characterization
- `quadraticModule_add_mem` - Closed under addition
- `quadraticModule_smul_mem` - Closed under ‚â•0 scalar multiplication

**Mathlib deps:** `Geometry.Convex.Cone.Basic`

#### File 1.3: `Archimedean.lean` (~40 LOC)
```
The Archimedean property: ‚àÄa, ‚àÉN, N¬∑1 - a*a ‚àà M
```

**Key definitions:**
- `IsArchimedean (M : ConvexCone ‚Ñù A)` - The property
- `archimedean_bound (a : A)` - Witness N for element a

#### File 1.4: `MPositiveState.lean` (~80 LOC)
```
M-positive states: linear œÜ with œÜ(1)=1, œÜ(m)‚â•0 for m‚ààM
```

**Key definitions:**
- `MPositiveState (A : Type*) (M : ConvexCone ‚Ñù A)` - Structure
- `MPositiveStateSet` - The set S_M of all M-positive states
- `apply_m_nonneg` - œÜ(m) ‚â• 0 for m ‚àà M

**Mathlib deps:** `Analysis.Normed.Module.Dual`

---

### Phase 2: Boundedness and Cone Structure (3 files, ~120 LOC)

#### File 2.1: `BoundednessLemma.lean` (~50 LOC)
```
|œÜ(a)|¬≤ ‚â§ œÜ(a*a) ‚â§ N‚Çê for M-positive states
```

**Key lemmas:**
- `cauchy_schwarz_mpositive` - |œÜ(a)|¬≤ ‚â§ œÜ(a*a) (uses GNS CS)
- `archimedean_bound_mpositive` - œÜ(a*a) ‚â§ N‚Çê
- `eval_bounded` - |œÜ(a)| ‚â§ ‚àöN‚Çê

**Deps:** Phase 1, AfTests/GNS/State/CauchySchwarz

#### File 2.2: `GeneratingCone.lean` (~40 LOC)
```
M ‚à© (A‚ÇÄ)_sa is generating for (A‚ÇÄ)_sa
```

**Key lemmas:**
- `selfAdjoint_decomp` - x = ¬º(1+x)*(1+x) - ¬º(1-x)*(1-x)
- `quadraticModule_generating` - Every SA element is difference of M elements

**Mathlib deps:** `Algebra.Star.SelfAdjoint`

#### File 2.3: `Continuity.lean` (~30 LOC)
```
M-positive states are ||¬∑||_M-continuous
```

**Key lemmas:**
- `mpositive_lipschitz` - |œÜ(a)| ‚â§ ||a||_M

---

### Phase 3: Compactness of S_M (2 files, ~80 LOC)

#### File 3.1: `StateSpaceTopology.lean` (~40 LOC)
```
Equip (A‚ÇÄ)* with pointwise convergence topology
```

**Key definitions:**
- `stateSpaceTopology` - Induced from product topology
- `eval_continuous` - Evaluation maps are continuous

**Mathlib deps:** `Topology.Algebra.Module.WeakDual`

#### File 3.2: `StateSpaceCompactness.lean` (~40 LOC)
```
S_M is compact in weak-* topology
```

**Key lemmas:**
- `state_space_bounded` - S_M ‚äÜ ‚àè Disk(‚àöN‚Çê)
- `state_space_closed` - S_M is closed (intersection of preimages)
- `state_space_compact` - Tychonoff + closed ‚üπ compact

**Mathlib deps:** `Topology.Compactness.Compact` (Tychonoff)

---

### Phase 4: Seminorm and Closure (3 files, ~100 LOC)

#### File 4.1: `StateSeminorm.lean` (~40 LOC)
```
||a||_M := sup{|œÜ(a)| : œÜ ‚àà S_M}
```

**Key definitions:**
- `stateSeminorm` - The seminorm ||¬∑||_M
- `stateSeminorm_finite` - ||a||_M ‚â§ ‚àöN‚Çê < ‚àû

**Mathlib deps:** `Analysis.Seminorm`

#### File 4.2: `QuadraticModuleClosure.lean` (~30 LOC)
```
MÃÑ = closure of M in ||¬∑||_M topology
```

**Key definitions:**
- `quadraticModuleClosure` - MÃÑ
- `closure_is_cone` - MÃÑ is a convex cone
- `kernel_in_closure` - N ‚äÜ MÃÑ where N = {a : ||a||_M = 0}

**Mathlib deps:** `Analysis.Convex.Cone.Closure`

#### File 4.3: `SeminormEquivalence.lean` (~30 LOC)
```
On self-adjoints: ||¬∑||_M = ||¬∑||_{C*} (constrained C*-seminorm)
```

**Key lemmas:**
- `cstar_le_state_seminorm` - ||a||_{C*} ‚â§ ||a||_M
- `state_le_cstar_seminorm` - ||a||_M ‚â§ ||a||_{C*} (uses GNS)

**Deps:** Phase 1, GNS infrastructure

---

### Phase 5: Dual Characterization (4 files, ~160 LOC)

#### File 5.1: `DualForward.lean` (~30 LOC)
```
A ‚àà MÃÑ ‚üπ œÜ(A) ‚â• 0 for all œÜ ‚àà S_M
```

**Key lemmas:**
- `closure_implies_nonneg` - Limit of nonnegatives is nonnegative

#### File 5.2: `SeparatingFunctional.lean` (~50 LOC)
```
If A ‚àâ MÃÑ, construct œà‚ÇÄ on span{A} with œà‚ÇÄ(A) < 0
```

**Key lemmas:**
- `span_cap_M_trivial` - M ‚à© span{A} = {0} when A ‚àâ MÃÑ
- `separating_on_span` - Define œà‚ÇÄ(ŒªA) = -ŒªŒµ

#### File 5.3: `RieszExtension.lean` (~40 LOC)
```
Extend œà‚ÇÄ to œà on all of (A‚ÇÄ)_sa using Riesz-Kantorovich
```

**Key lemmas:**
- `extend_to_selfadjoint` - œà : (A‚ÇÄ)_sa ‚Üí ‚Ñù with œà ‚â• 0 on M ‚à© (A‚ÇÄ)_sa
- `extension_negative_at_A` - œà(A) = -Œµ < 0

**Mathlib deps:** `Analysis.Convex.Cone.Extension` (`riesz_extension`)

#### File 5.4: `DualBackward.lean` (~40 LOC)
```
Complete the (‚ü∏) direction and combine
```

**Key lemmas:**
- `complex_extension` - Extend œà to œÜ : A‚ÇÄ ‚Üí ‚ÑÇ
- `normalize_state` - œÜ‚ÇÅ = œÜ/œà(1) ‚àà S_M
- `contradiction` - œÜ‚ÇÅ(A) < 0 contradicts hypothesis
- `dual_characterization` - Main theorem 5.1

---

### Phase 6: Conclusion (3 files, ~100 LOC)

#### File 6.1: `ConstrainedRepresentation.lean` (~40 LOC)
```
Constrained *-representation: œÄ with œÄ(g‚±º) ‚â• 0
```

**Key definitions:**
- `ConstrainedStarRep` - Structure for constrained representations
- `vector_state_mpositive` - Vector states from constrained reps are M-positive

**Deps:** GNS infrastructure

#### File 6.2: `GNSConstrained.lean` (~40 LOC)
```
GNS of M-positive state gives constrained representation
```

**Key lemmas:**
- `gns_rep_generator_positive` - œÄ_œÜ(g‚±º) ‚â• 0
- `gns_rep_bounded` - ||œÄ_œÜ(a)|| ‚â§ ‚àöN‚Çê

**Deps:** GNS infrastructure, Phase 1

#### File 6.3: `MainTheorem.lean` (~20 LOC)
```
Main theorem combining all results
```

**Key theorem:**
```lean
theorem main_theorem (A : (A‚ÇÄ)_sa) :
    A ‚àà quadraticModuleClosure ‚Üî
    ‚àÄ œÄ : ConstrainedStarRep, 0 ‚â§ œÄ A
```

---

### Appendix (1 file, ~40 LOC)

#### File A.1: `NonEmptiness.lean` (~40 LOC)
```
S_M ‚â† ‚àÖ via scalar extraction functional
```

**Key lemmas:**
- `scalar_extraction` - œÜ‚ÇÄ(a) = coefficient of empty word
- `scalar_extraction_mpositive` - œÜ‚ÇÄ ‚àà S_M

---

## Dependency Graph

```
Phase 1 (Algebraic Setup)
    ‚îÇ
    ‚îú‚îÄ‚îÄ 1.1 FreeStarAlgebra
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îî‚îÄ‚îÄ 1.2 QuadraticModule
    ‚îÇ               ‚îÇ
    ‚îÇ               ‚îú‚îÄ‚îÄ 1.3 Archimedean
    ‚îÇ               ‚îÇ
    ‚îÇ               ‚îî‚îÄ‚îÄ 1.4 MPositiveState
    ‚îÇ                       ‚îÇ
    ‚ñº                       ‚ñº
Phase 2 (Boundedness)    Phase 3 (Compactness)
    ‚îÇ                       ‚îÇ
    ‚îú‚îÄ‚îÄ 2.1 BoundednessLemma
    ‚îÇ       ‚îÇ
    ‚îú‚îÄ‚îÄ 2.2 GeneratingCone
    ‚îÇ
    ‚îî‚îÄ‚îÄ 2.3 Continuity
            ‚îÇ
            ‚ñº
      Phase 4 (Seminorm)
            ‚îÇ
            ‚îú‚îÄ‚îÄ 4.1 StateSeminorm
            ‚îÇ
            ‚îú‚îÄ‚îÄ 4.2 Closure
            ‚îÇ
            ‚îî‚îÄ‚îÄ 4.3 SeminormEquiv
                    ‚îÇ
                    ‚ñº
              Phase 5 (Dual)
                    ‚îÇ
                    ‚îú‚îÄ‚îÄ 5.1 Forward
                    ‚îÇ
                    ‚îú‚îÄ‚îÄ 5.2 Separating
                    ‚îÇ
                    ‚îú‚îÄ‚îÄ 5.3 Riesz
                    ‚îÇ
                    ‚îî‚îÄ‚îÄ 5.4 Backward
                            ‚îÇ
                            ‚ñº
                      Phase 6 (Conclusion)
                            ‚îÇ
                            ‚îî‚îÄ‚îÄ 6.3 MainTheorem
```

---

## Risk Assessment

### Low Risk (mathlib support strong)
- Tychonoff theorem
- Riesz extension
- Cone closures
- Seminorm properties

### Medium Risk (need custom work)
- Free *-algebra with SA generators
- M-positive state structure
- Seminorm ||¬∑||_M definition

### High Risk (complex proofs)
- Quadratic module generating property
- GNS representation is constrained
- Seminorm equivalence proof

---

## Key Mathlib Imports

```lean
import Mathlib.Algebra.FreeAlgebra
import Mathlib.Algebra.Star.Basic
import Mathlib.Algebra.Star.SelfAdjoint
import Mathlib.Analysis.Convex.Cone.Extension  -- Riesz extension!
import Mathlib.Analysis.Convex.Cone.Closure
import Mathlib.Analysis.Seminorm
import Mathlib.Analysis.Convex.Gauge
import Mathlib.Topology.Compactness.Compact  -- Tychonoff
import Mathlib.Topology.Algebra.Module.WeakDual
import Mathlib.Geometry.Convex.Cone.Basic
```

---

## Implementation Order

1. **Phase 1.1-1.2**: FreeStarAlgebra, QuadraticModule (foundation)
2. **Phase 1.3-1.4**: Archimedean, MPositiveState (core structures)
3. **Phase 2.1-2.2**: BoundednessLemma, GeneratingCone (key lemmas)
4. **Appendix**: NonEmptiness (ensures S_M well-defined)
5. **Phase 3**: Compactness (Tychonoff application)
6. **Phase 4**: Seminorm infrastructure
7. **Phase 5.1-5.2**: Forward direction + separation
8. **Phase 5.3**: Riesz extension application
9. **Phase 5.4**: Complete dual characterization
10. **Phase 6**: GNS integration + main theorem
