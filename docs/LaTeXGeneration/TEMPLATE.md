# Subagent Template for LaTeX Conversion

## Your Task
Convert the specified Lean files to a LaTeX chapter following this exact format.

---

## Output Format

```latex
% Chapter: [TITLE]
% Generated from: [list of .lean files]

\chapter{[Title]}
\label{ch:[label]}

% Opening prose from /-! ... -/ block
[Section introduction extracted from module docstring]

%% ============================================================
\section{[Section Name]}
\label{sec:[label]}

% From /-- docstring -/
[Explanation of what follows]

\begin{definition}[Name]\label{def:[lean-name]}
Let $[variables]$. We define \textbf{[name]} as [definition].
\[
  [formal definition in LaTeX math]
\]
\end{definition}

\begin{theorem}[Name]\label{thm:[lean-name]}
[Statement in mathematical English]
\end{theorem}

\begin{proof}[Proof sketch]
[High-level proof idea extracted from tactic proof structure and comments]
\end{proof}

\begin{lemma}[Name]\label{lem:[lean-name]}
[Statement]
\end{lemma}

\begin{proof}
[Proof sketch]
\end{proof}

%% ============================================================
\section{Next Section}
...
```

---

## Extraction Rules

### 1. Module Docstrings (`/-! ... -/`)
Convert to section introductions:
```lean
/-! # Section Title

This file does X, Y, Z.

## Main results
* `foo` - does A
* `bar` - does B
-/
```
Becomes:
```latex
\section{Section Title}

This section establishes X, Y, and Z.

The main results are:
\begin{itemize}
  \item \texttt{foo} (Definition~\ref{def:foo}): does A
  \item \texttt{bar} (Theorem~\ref{thm:bar}): does B
\end{itemize}
```

### 2. Definitions (`def`, `abbrev`)
```lean
/-- The quadratic module M generated by constraints. -/
def QuadraticModule (n : ℕ) : Set (FreeStarAlgebra n) :=
  { x | ∃ (terms : List ...), ... }
```
Becomes:
```latex
\begin{definition}[Quadratic Module]\label{def:QuadraticModule}
The \textbf{quadratic module} $M \subseteq \mathcal{A}_0$ is defined as
\[
  M = \left\{ \sum_i a_i^* a_i + \sum_{j,k} b_{jk}^* g_j b_{jk}
      : a_i, b_{jk} \in \mathcal{A}_0 \right\}
\]
\end{definition}
```

### 3. Structures/Classes
```lean
/-- An M-positive state on the free *-algebra. -/
structure MPositiveState (n : ℕ) where
  toFun : FreeStarAlgebra n →ₗ[ℝ] ℝ
  map_star : ∀ a, toFun (star a) = toFun a
  map_one : toFun 1 = 1
  map_m_nonneg : ∀ m ∈ QuadraticModule n, 0 ≤ toFun m
```
Becomes:
```latex
\begin{definition}[$M$-Positive State]\label{def:MPositiveState}
An \textbf{$M$-positive state} is a linear functional
$\varphi : \mathcal{A}_0 \to \mathbb{R}$ satisfying:
\begin{enumerate}
  \item (Symmetric) $\varphi(a^*) = \varphi(a)$ for all $a$
  \item (Normalized) $\varphi(1) = 1$
  \item ($M$-positive) $\varphi(m) \ge 0$ for all $m \in M$
\end{enumerate}
\end{definition}
```

### 4. Theorems/Lemmas
```lean
/-- Cauchy-Schwarz: |φ(a)|² ≤ φ(a*a) · φ(1). -/
theorem cauchy_schwarz (φ : MPositiveState n) (a : FreeStarAlgebra n) :
    φ a ^ 2 ≤ φ (star a * a) * φ 1 := by
  -- quadratic in t argument
  have hquad : ∀ t, 0 ≤ φ (star (a + t • 1) * (a + t • 1)) := ...
  -- discriminant bound
  ...
```
Becomes:
```latex
\begin{theorem}[Cauchy--Schwarz]\label{thm:cauchy_schwarz}
For any $M$-positive state $\varphi$ and $a \in \mathcal{A}_0$,
\[
  |\varphi(a)|^2 \le \varphi(a^* a) \cdot \varphi(1).
\]
\end{theorem}

\begin{proof}[Proof sketch]
Consider the quadratic $q(t) = \varphi((a + t \cdot 1)^*(a + t \cdot 1)) \ge 0$.
Expanding and using linearity gives $q(t) = \varphi(a^*a) + 2t\varphi(a) + t^2\varphi(1)$.
The discriminant must be non-positive, yielding the result.
\end{proof}
```

### 5. Instances (usually omit or inline)
Skip most instances unless mathematically significant. If important:
```latex
\begin{remark}
The set of $M$-positive states is non-empty; the scalar state
$\varphi_0(a) = \varepsilon(a)$ (where $\varepsilon$ is the augmentation)
provides an example.
\end{remark}
```

---

## Symbol Translation Table

| Lean | LaTeX | Example |
|------|-------|---------|
| `FreeStarAlgebra n` | `\mathcal{A}_0` | The free *-algebra |
| `QuadraticModule n` | `M` | The quadratic module |
| `MPositiveState n` | `\varphi \in S_M` | An M-positive state |
| `quadraticModuleClosure` | `\bar{M}` | Closure of M |
| `stateSeminorm a` | `\|a\|_M` | State seminorm |
| `ConstrainedStarRep n` | `\pi` | Constrained *-rep |
| `generator j` | `g_j` | j-th generator |
| `star a` | `a^*` | Involution |
| `IsSelfAdjoint a` | `a = a^*` | Self-adjoint |
| `IsPositive T` | `T \ge 0` | Positive operator |
| `gnsHilbertSpace` | `\mathcal{H}_\varphi` | GNS Hilbert space |

---

## Cross-Reference Format

Use `\ref` and `\eqref` for cross-references:
- Definitions: `Definition~\ref{def:name}`
- Theorems: `Theorem~\ref{thm:name}`
- Lemmas: `Lemma~\ref{lem:name}`
- Sections: `Section~\ref{sec:name}`
- Equations: `\eqref{eq:name}`

---

## Proof Sketch Guidelines

1. **Do NOT copy tactic proofs verbatim**
2. Extract the key mathematical ideas
3. Mention which lemmas/theorems are applied
4. Use phrases like:
   - "By Theorem~\ref{thm:X}..."
   - "The proof proceeds by contradiction..."
   - "Applying the Cauchy-Schwarz inequality..."
   - "By density and continuity..."

---

## File Header

Every output file starts with:
```latex
% Auto-generated from Lean 4 source
% Source files: [list]
% Do not edit manually

```

---

## Checklist Before Submitting

- [ ] All `def`/`theorem`/`lemma` from source files included
- [ ] All docstrings converted to prose
- [ ] Labels follow naming convention
- [ ] Cross-references use `\ref`
- [ ] No raw Lean syntax in output
- [ ] ≤ 300 lines
- [ ] Compiles standalone (with preamble)
